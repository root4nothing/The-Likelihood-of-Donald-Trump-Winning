---
title: The Likelihood of Donald Trump winning the 2020 Presidential Election? A Data
  Analysis on American Survey and Census Data
author: "root4nothing"
date: "2020/1/6"
output: pdf_document
---

```{r setup, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(haven)
library(tidyverse)
library(lme4)
library(lattice)
library(MASS)
setwd("~/Desktop/Projects/Data")
survey_data <- read.csv("survey_data.csv")
census_data <- read.csv("census_data.csv")
```

## Introduction

Between Republican candidate Donald Trump and Democrat candidate Joe Biden, the presidential election in the United States in 2020 appears to be heating up until November 3rd. It draws attention to the US's recognized economic supremacy and super-powerful political position around the world. In this study, we focus on two datasets that contain data from a poll survey and a demographic census. Hierarchical logistic regression models are used to evaluate any factors that are statistically connected with the chance of voting for Donald Trump based on survey data. We then create a credible election prediction using the census dataset and a trained model.

## Data

Democracy Fund and UCLA Nationscape provided the survey dataset for modeling. We processed data cleansing at the beginning in order to model with tidy and ordered data. For example, we only look at those who have registered to vote; we create an age group so that age is a categorized rather than a continuous variable; and we divide family income into three levels: lower, middle, and upper. We have restructured the race ethnicity and educational backgrounds to provide a clearer explanation. The survey dataset contains 3,879 observations and 8 variables after missing values are removed, including both geographic variables like state and demographic variables like gender and age.


```{r, fig.width=10, fig.height=4, echo = F, fig.align="center", fig.cap='Proportions of Trump and Biden supports across U.S.'}
survey_data %>% 
  ggplot(mapping = aes(x = state, fill = voteintention)) +
  geom_bar() + 
  labs(x = "State",
       y = "Count") + 
  theme(axis.text.x = element_text(angle = 45)) +    
  scale_fill_manual(values=c("#999999", "#E69F00")) 
```



## Method

Because the response variable we were looking for is binary: either support for Trump or support for Biden. A generalized linear model with a logit link is the rational option for representing this type of data. The Electoral College, on the other hand, determines the presidential election system in the United States, which implies that a candidate who receives the most votes may not win the election. In the 2016 Presidential Election, for example, Hillary Clinton received over 3 million more votes in the final vote tally than Trump, but Trump won the election president. Figure 1 clearly demonstrates that Trump and Biden's support varies substantially across the country; hence, geographic variance should be taken into account for more reasonable and accurate modeling refers to a rate of supporting.

### Variance Component Model 

The variance components model is a multilevel model without an explanatory variable that can be used to explain variation in supporting for Trump that can be attributed to states. It has the following basic form for a bianry response:

$$
Y_{ij} \sim Binomial(\pi_{ij}) \\
logit(\pi_{ij}) = \mathbf{X}_{i}\beta + \mu_j+\epsilon_{ij}
$$
where $\pi_{ij}$ is the probability of $i$th individual voting Trump living in $j$th state, $j$th is the deviation in probability of voting Trumpof at $j$th states from average, $\epsilon_{ij}$ is the error term. 




```{r, echo = F, results = 'hide'}
# null model
fit0 <- glm(vote_trump ~  1, data = survey_data, family = "binomial" )
# variation in states
fit_st <- glmer(vote_trump ~  1 + (1 | state), data = survey_data, family = "binomial")
anova(fit_st, fit0)
summary(fit_st)
anova(fit_st, fit0)
```


```{r, fig.height=5.2, fig.width=4.5, fig.align='center', fig.cap='Random effect of states by variance component model', echo = F}

results = dotplot(ranef(fit_st))
results$state

```

\newpage

Figure 2 depicts the estimated random effect generated by the variance component model. The graphic evidence does show that the proportion of Trump supporters differs by state. However, we see that the 95% confidence interval overlaps the horizontal line at zero in a large number of states, indicating that the likelihood of backing Trump in these states is neither significantly above nor below normal. A likelihood ratio test comparing the logistic variance component model to a null logistic model, on the other hand, shows that the multilevel model fits the data better than a single level model.

### Variable selection

We use Efroymson's method of forward and backward stepwise regression to allocate an optimal combination of explanatory variables for fitting our model (1960). A set of criteria, including as AIC, BIC, and Mallows' Cp, are used to simplify the algorithms used in this selection process. We have a stepwise selected model with variables of gender, age group, race ethnicity, educational background, income level, and working status according to R programming.

```{r, echo = F}
full.model <- glm(vote_trump ~gender + agegroup + race + incomelevel + educationl + workingstatus, family = "binomial", data = survey_data)
step.model <- stepAIC(full.model, direction = "both", 
                      trace = FALSE)

```

### Post-Stratification

MRP (multilevel regression with post-stratification) is a prominent and commonly used technique for forecasting election results from polling. The basic idea behind MRP is to estimate the targeted population from a sample population using multilevel regression, which is a convenient way to estimate public opinion across geographic units using individual-level survey data. For the survey and census data we used in this study, all of the factors in the census dataset that we would use for prediction were restructured to match the variables we chose for regression.

## Results

Aside from geographic variations in Trump support, we also find that there are changes across multiple levels of variables, such as random effects on gender, ethnicity, age group, and even income level, as seen in Figure 3.

In addition, the GLMM model results in Tables 1 and 2 reveal that gender, age group, race, income level, and working status are all significantly connected to the chance of voting for Trump. For example, the gender coefficient is calculated negatively, meaning that male voters are more excited about Trump than female voters. The likelihood of male voters supporting Trump is equal to the probability of female voters multiplied by a factor of. Similarly, Trump supporters are more likely to be older persons with a higher income (household income > $129,999). Furthermore, there are differences in support favor among race ethnicities: When compared to Black Americans, the likelihood of voting for Trump in White Americans are multiples of that of Black Americans.

As a result, we apply this GLMM regression to the cleaning census dataset as a method of post-stratification and find that the proportion of voters in favor of voting for Donald Trump is 35.78 percent, implying that Trump's chances of winning this presidential election are not promising if only the polling results on the survey and census data are taken into account. However, as previously stated, the number of electoral districts, rather than the overall proportion of supported voters, is the key to winning an election in the United States.

```{r, echo = F}
# variation in age
fit_age <- glmer(vote_trump ~  1 + (1 | agegroup), data = survey_data, family = "binomial")
fit_race <- glmer(vote_trump ~  1 + (1 | race), data = survey_data, family = "binomial")
fit_income <- glmer(vote_trump ~  1 + (1 | incomelevel), data = survey_data, family = "binomial")
fit_gender <- glmer(vote_trump ~  1 + (1 | gender), data = survey_data, family = "binomial")
fit_work <- glmer(vote_trump ~  1 + (1 | workingstatus), data = survey_data, family = "binomial")
fit_ed  <- glmer(vote_trump ~  1 + (1 | educationl), data = survey_data, family = "binomial")
```


```{r, echo = F, fig.width= 2.8, fig.height=3, fig.cap='Heterogeneous effects of variables on the probability of supporting Trump'}
r1 = dotplot(ranef(fit_age))
r2 = dotplot(ranef(fit_race))
r3 = dotplot(ranef(fit_income))
r4 = dotplot(ranef(fit_gender))
r5 = dotplot(ranef(fit_work))
r6 = dotplot(ranef(fit_ed))

r1$agegroup
r2$race
r3$incomelevel
r4$gender
r5$workingstatus
r6$educationl
```


```{r, echo = F, results = 'hide'}
stepfit <- glmer(vote_trump ~gender + agegroup + race  + educationl + incomelevel + workingstatus + (1|state), family = "binomial", data = survey_data)

(theCiMat = Pmisc::ciMat(0.95))
parTable = summary(
stepfit)$coef[, rownames(theCiMat)] %*% theCiMat
rownames(parTable)[1]= "Baseline"

```

```{r, echo = F}
knitr::kable(summary(stepfit)$coef, digits = 3, 
             caption = 'Coefficient estimation of the GLMM')
knitr::kable(exp(parTable), digits = 3, 
             caption = 'MLE’s of baseline odds and odds ratios with 95% confidence intervals')
fit2 <- glm(vote_trump ~gender + agegroup + race  + educationl + workingstatus, family = "binomial", data = survey_data)
y <- predict(fit2, newdata = census_data, type = "response")

```

```{r, echo = F, results='hide'}
length(which(y > 0.5))/length(y)
```


## Discussion

As a result, we apply this GLMM regression to the cleaning census dataset as a method of post-stratification and find that the proportion of voters in favor of voting for Donald Trump is 35.78 percent, implying that Trump's chances of winning this presidential election are not promising if only the polling results on the survey and census data are taken into account. However, as previously stated, the number of electoral districts, rather than the overall proportion of supported voters, is the key to winning an election in the United States. However, given to the election laws, this does not rule out the possibility of Trump winning.

Although we discovered several fascinating findings, as we described above, there are numerous flaws in our study that should be noted and rectified for future research. Because GLMM is a straightforward frequentist model, which is estimated by the likelihood function on fixed supplied parameters, the first issue we evaluate is the efficiency and correctness of our hierarchical logistic regression model. However, because the willingness to support a candidate is a personal emotional experience that is difficult to model, a Bayesian study may be better appropriate for thoroughly evaluating the possibility of Trump's support. Furthermore, because the census data we collected did not include regional household income information, a post-stratification analysis was used to forecast the model without these two components. We need to make a precise prediction based on a more specific census data. 

In order to conduct future research, we plan to summarize our expected fraction of Trump voters by state and compare our predictions after the results of the 2020 US Presidential Election are known.

## Bibliography

[1] Skrondal, A., & Rabe‐Hesketh, S. (2009). Prediction in multilevel generalized
linear models. Journal of the Royal Statistical Society: Series A (Statistics in
Society), 172(3), 659-687.

[2] Harrell, F. E. (2001) "Regression modeling strategies: With applications to linear models, logistic regression, and survival analysis," Springer-Verlag, New York.

[3] Reilly, C., Gelman, A., & Katz, J. (2001). Poststratification without population level information on the poststratifying variable with application to political polling. Journal of the American Statistical Association, 96(453), 1-1

[4] Buttice, M. K., & Highton, B. (2013). How does multilevel regression and
poststratification perform with conventional national surveys?. Political analysis,
449-467.

[5] Anuta, D., Churchin, J., & Luo, J. (2017). Election bias: Comparing polls and twitter in the 2016 us election. arXiv preprint arXiv:1701.06232.